<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>BCM AI Avatar (Interactive)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    html, body { height:100%; margin:0; background:#000; }
    /* Dev-only mini tester styles */
    #bcm-tester { position:fixed; right:14px; bottom:14px; z-index:99999; max-width:360px;
      background:#0b1220; color:#e6eefc; border:1px solid #2a3a5a; border-radius:14px; padding:12px; font:14px/1.35 system-ui; }
    #bcm-tester button { padding:6px 10px; border:0; border-radius:10px; background:#1e2b4a; color:#cfe0ff; cursor:pointer; }
    #bcm-tester textarea { width:100%; border-radius:10px; border:1px solid #2a3a5a; background:#0f1730; color:#cfe0ff; padding:8px; }
  </style>
  <!-- Add external SDKs -->
  <script src="https://unpkg.com/livekit-client/dist/livekit-client.umd.js"></script>
  <script src="https://unpkg.com/@heygen/streaming-sdk/dist/index.umd.js"></script>
</head>
<body>

  <!-- Dev-only mini tester (remove later if you want) -->
  <div id="bcm-tester">
    <div style="display:flex;justify-content:space-between;gap:8px;align-items:center;margin-bottom:8px;">
      <strong>BCM Tester</strong>
      <button id="bcm-close">Ã—</button>
    </div>
    <div style="display:flex;gap:6px;flex-wrap:wrap;margin-bottom:8px;">
      <button id="btn-health">Health</button>
      <button id="btn-courses">Courses</button>
      <button id="btn-faqs">FAQs</button>
      <button id="btn-token">Token</button>
      <button id="btn-enroll">Test Enroll</button>
    </div>
    <textarea id="bcm-out" rows="8" placeholder="Output appears here..."></textarea>
  </div>

  <!-- Load BCM bridge -->
  <script src="/script.js" defer></script>

  <!-- Wire tester after bridge is available -->
  <script>
    (function () {
      const $ = id => document.getElementById(id);
      const box = $('bcm-tester'), out = $('bcm-out');
      $('bcm-close').onclick = () => box.remove();

      $('btn-health').onclick  = async () => { out.value = JSON.stringify(await BCM.pingHealth(), null, 2); };
      $('btn-courses').onclick = async () => { out.value = await BCM.fetchCoursesText(); };
      $('btn-faqs').onclick    = async () => { out.value = await BCM.fetchFaqsText(); };

      $('btn-token').onclick   = async () => {
        const key = prompt('X-Admin-Key?');
        if (key) BCM.setAdminKey(key);
        const r = await BCM.fetchHeygenToken();
        out.value = JSON.stringify(r.data || r, null, 2);
      };

      $('btn-enroll').onclick  = async () => {
        const r = await BCM.createEnrollment({
          full_name: "Tester " + Math.floor(Math.random()*1000),
          email: "tester@example.com",
          phone: "12345678",
          course_id: 1,
          source: "avatar"
        });
        out.value = JSON.stringify(r, null, 2);
      };
    })();
  </script>
</body>
</html>
